{"version":3,"sources":["../../src/controllers/user.js"],"names":["UserController","create","req","res","next","_db","User","checkBody","body","getValidationResult","then","user","user_type","allowed_role","userType","admin","hr","guest","Interviewee","id","data","handleSuccessResponse","err","Error","json","error","message","catch","handleErrorResponse","bind","login","list","userFindAll","params","page","limit","deleteUser","userDelete","idResult","getById","logs","email","email_id","user_activity","length","getInterviewee","response","controller"],"mappings":"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","file":"user.js","sourcesContent":["import BaseAPIController from \"./BaseAPIController\";\nimport UserProvider from \"../providers/UserProvider.js\";\nimport constant from \"../models/constant\";\n\nexport class UserController extends BaseAPIController {\n\n    /* Controller for User Register  */\n    create = (req, res, next) => {\n        UserProvider.create(this._db.User, req.checkBody, req.body, req.getValidationResult())\n            .then((user) => {\n                let user_type = user.user_type;\n                let allowed_role = constant().userType;\n                if ((user_type == allowed_role.admin || user_type == allowed_role.hr || user_type == allowed_role.guest || user_type == allowed_role.Interviewee) && (req.user.id)) {\n                    this._db.User.create(user)\n                        .then((data) => {\n                            this.handleSuccessResponse(req, res, next, data)\n                        }, (err) => {\n                            throw new Error(res.json(400, {\n                                error: 1,\n                                message: err,\n                                data: []\n                            }));\n                        })\n                } else {\n                    throw new Error(res.json(400, {\n                        error: 1,\n                        message: \"Invalid User Type\",\n                        data: []\n                    }))\n                }\n            })\n            .catch(this.handleErrorResponse.bind(null, res));\n    }\n\n\n    /* Controller for User Login  */\n    login = (req, res, next) => {\n        let login = UserProvider.login(this._db.User, req.body);\n        this._db.User.login(login)\n            .then((data) => { this.handleSuccessResponse(req, res, next, data) })\n            .catch(this.handleErrorResponse.bind(null, res));\n    }\n\n    /*controller for user list*/\n    list = (req, res, next) => {\n        this._db.User.userFindAll(req.user, req.params.page, req.params.limit)\n            .then((data) => { this.handleSuccessResponse(req, res, next, { error: 0, message: \"success\", data: data }) })\n            .catch(this.handleErrorResponse.bind(null, res));\n    }\n\n    /*Controller for user delete*/\n    deleteUser = (req, res, next) => {\n        this._db.User.userDelete(req.user, req.params.id)\n            .then((data) => { this.handleSuccessResponse(req, res, next, { error: 0, message: \"success\", data: data }) })\n            .catch(this.handleErrorResponse.bind(null, res));\n    }\n\n    /*Find Id result*/\n    idResult = (req, res, next, id) => {\n        this.getById(req, res, this._db.User, id, next)\n    }\n\n    logs = (req, res, next) => {\n        let email = req.params.email_id;\n        this._db.User.logs(req.user_activity, email)\n            .then((data) => {\n                if (data.length)\n                    this.handleSuccessResponse(req, res, next, { error: 0, message: \"success\", data: data })\n                else\n                    this.handleSuccessResponse(req, res, next, { error: 0, message: \"No Logs Found\", data: data })\n            })\n            .catch(this.handleErrorResponse.bind(null, res));\n    }\n\n    getInterviewee = (req, res, next) => {\n        this._db.User.getInterviewee().then((response) => {\n            this.handleSuccessResponse(req, res, next, response)\n        })\n    }\n}\n\nconst controller = new UserController();\nexport default controller;"]}